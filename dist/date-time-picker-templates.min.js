"use strict";angular.module("deft.date_time_picker",["ui.bootstrap","angularMoment"]).provider("DateTimePickerDefaultConfig",function(){var t={decline:"Decline",accept:"Accept",dateLabel:"Date",dateFormat:"dd D MMM YYYY",timeLabel:"Time",timeFormat:"HH:mm",step:1,useTimePicker:!0};this.decline=function(e){t.decline=e},this.accept=function(e){t.accept=e},this.dateLabel=function(e){t.dateLabel=e},this.dateFormat=function(e){t.dateFormat=e},this.timeLabel=function(e){t.timeLabel=e},this.timeFormat=function(e){t.timeFormat=e},this.step=function(e){t.step=e},this.useTimePicker=function(e){t.useTimePicker=e},this.$get=function(){return t}}).directive("dateTimePicker",["DateTimePickerDefaultConfig",function(t){return{restrict:"E",templateUrl:"templates/dateTimePicker.html",replace:!0,require:"ngModel",scope:{dateTime:"=ngModel",customConfig:"=config",minDate:"=",maxDate:"="},link:{pre:function(e){function a(){e.minDate&&!e.minDate._isAMomentObject||e.maxDate&&!e.maxDate._isAMomentObject||e.dateTime&&e.dateTime._isAMomentObject&&(e.minDate&&e.dateTime.format()!=e.minDate.format()&&e.dateTime<e.minDate&&(e.dateTime=angular.copy(e.minDate)),e.maxDate&&e.dateTime.format()!=e.maxDate.format()&&e.dateTime>e.maxDate&&(e.dateTime=angular.copy(e.maxDate)))}function i(){e.config=_.defaults(e.customConfig?e.customConfig:{},t)}i(),e.$watch("dateTime",a),e.$watch("minDate",a),e.$watch("maxDate",a),e.$watch("customConfig",function(t,e){t!=e&&i()})}}}}]).directive("datePicker",["$modal",function(t){return{restrict:"E",templateUrl:"templates/datePicker.html",replace:!0,scope:{date:"=",config:"="},link:function(e){e.pickDate=function(){console.log(t),t.open({windowClass:"deft-date-time-picker-modal",templateUrl:"templates/datePickerModal.html",controller:"DateTimePickerCtrl",resolve:{dateTime:function(){return angular.copy(e.date)},Config:function(){return e.config}}}).result.then(function(t){e.date=t})}}}}]).directive("timePicker",["$modal",function(t){return{restrict:"E",templateUrl:"templates/timePicker.html",replace:!0,scope:{time:"=",config:"="},link:function(e){function a(t){if(isNaN(t))return!1;var e=parseFloat(t);return(0|e)===e}function i(){var t=Math.floor(e.time.minutes()/e.config.step)*e.config.step;a(t)&&e.time.minutes(t)}i(),e.pickTime=function(){t.open({windowClass:"deft-date-time-picker-modal",templateUrl:"templates/timePickerModal.html",controller:"DateTimePickerCtrl",resolve:{dateTime:function(){return angular.copy(e.time)},Config:function(){return e.config}}}).result.then(function(t){e.time=t,i()})},e.$watch("config.step",i)}}}]).controller("DateTimePickerCtrl",["$scope","$modalInstance","dateTime","Config",function(t,e,a,i){t.dateTime=a,t.config=i,t.adjustDate=function(e,a){t.dateTime.add(a,e)},t.ok=function(t){e.close(t)},t.cancel=function(){e.dismiss()}}]),angular.module("deft.date_time_picker").run(["$templateCache",function(t){t.put("templates/datePicker.html",'<div class="deft-date-time-picker-date-picker" ng-click="pickDate()">{{ date | amDateFormat: config.dateFormat }}</div>\n'),t.put("templates/datePickerModal.html",'<div>\n    <div class="tableWrapper">\n        <table>\n            <tr class="adjust-row">\n                <td class="large"></td>\n                <td ng-click="adjustDate(10, \'day\')"><i class="fa fa-angle-double-up"></i></td>\n                <td ng-click="adjustDate(10, \'month\')"><i class="fa fa-angle-double-up"></i></td>\n                <td ng-click="adjustDate(10, \'year\')"><i class="fa fa-angle-double-up"></i></td>\n            </tr>\n            <tr class="adjust-row">\n                <td class="large"></td>\n                <td ng-click="adjustDate(1, \'day\')"><i class="fa fa-angle-up"></i></td>\n                <td ng-click="adjustDate(1, \'month\')"><i class="fa fa-angle-up"></i></td>\n                <td ng-click="adjustDate(1, \'year\')"><i class="fa fa-angle-up"></i></td>\n            </tr>\n            <tr class="date-time-row">\n                <td class="large align-left">{{ dateTime | amDateFormat: "dddd" }}</td>\n                <td class="date-time-text">{{ dateTime | amDateFormat:"DD" }}</td>\n                <td class="date-time-text">{{ dateTime | amDateFormat:"MMM" }}</td>\n                <td class="date-time-text">{{ dateTime | amDateFormat:"YYYY" }}</td>\n            </tr>\n            <tr class="adjust-row">\n                <td class="large"></td>\n                <td ng-click="adjustDate(-1, \'day\')"><i class="fa fa-angle-down"></i></td>\n                <td ng-click="adjustDate(-1, \'month\')"><i class="fa fa-angle-down"></i></td>\n                <td ng-click="adjustDate(-1, \'year\')"><i class="fa fa-angle-down"></i></td>\n            </tr>\n            <tr class="adjust-row">\n                <td class="large"></td>\n                <td ng-click="adjustDate(-10, \'day\')"><i class="fa fa-angle-double-down"></i></td>\n                <td ng-click="adjustDate(-10, \'month\')"><i class="fa fa-angle-double-down"></i></td>\n                <td ng-click="adjustDate(-10, \'year\')"><i class="fa fa-angle-double-down"></i></td>\n            </tr>\n        </table>\n    </div>\n    <div>\n        <div class="btn btn-default" ng-click="cancel()">{{ config.decline }}</div>\n        <div class="btn btn-primary" ng-click="ok(dateTime)">{{ config.accept }}</div>\n    </div>\n</div>\n'),t.put("templates/dateTimePicker.html",'<div class="deft-date-time-picker">\n    <div class="deft-date-time-picker-date">\n        <label ng-show="config.dateLabel">{{ config.dateLabel }}</label>\n        <date-picker date="dateTime" config="config"></date-picker>\n    </div>\n    <div class="deft-date-time-picker-time" ng-show="config.useTimePicker !== false">\n        <label ng-show="config.timeLabel">{{ config.timeLabel }}</label>\n        <time-picker time="dateTime" config="config"></time-picker>\n    </div>\n</div>\n'),t.put("templates/timePicker.html",'<div class="deft-date-time-picker-time-picker" ng-click="pickTime()">{{ time | amDateFormat: config.timeFormat }}</div>\n'),t.put("templates/timePickerModal.html",'<div>\n    <div class="tableWrapper">\n        <table>\n            <tr class="adjust-row">\n                <td></td>\n                <td ng-click="adjustDate(12, \'hour\')"><i class="fa fa-angle-double-up"></i></td>\n                <td class="small"></td>\n                <td ng-click="adjustDate(config.step*10, \'minute\')"><i class="fa fa-angle-double-up"></i></td>\n                <td></td>\n            </tr>\n            <tr class="adjust-row">\n                <td></td>\n                <td ng-click="adjustDate(1, \'hour\')"><i class="fa fa-angle-up"></i></td>\n                <td class="small"></td>\n                <td ng-click="adjustDate(config.step, \'minute\')"><i class="fa fa-angle-up"></i></td>\n                <td></td>\n            </tr>\n            <tr class="date-time-row">\n                <td></td>\n                <td class="date-time-text">{{ dateTime | amDateFormat:"HH" }}</td>\n                <td class="small">:</td>\n                <td class="date-time-text">{{ dateTime | amDateFormat:"mm" }}</td>\n                <td></td>\n            </tr>\n            <tr class="adjust-row">\n                <td></td>\n                <td ng-click="adjustDate(-1, \'hour\')"><i class="fa fa-angle-down"></i></td>\n                <td class="small"></td>\n                <td ng-click="adjustDate(-config.step, \'minute\')"><i class="fa fa-angle-down"></i></td>\n                <td></td>\n            </tr>\n            <tr class="adjust-row">\n                <td></td>\n                <td ng-click="adjustDate(-12, \'hour\')"><i class="fa fa-angle-double-down"></i></td>\n                <td class="small"></td>\n                <td ng-click="adjustDate(-config.step*10, \'minute\')"><i class="fa fa-angle-double-down"></i></td>\n                <td></td>\n            </tr>\n        </table>\n    </div>\n    <div>\n        <div class="btn btn-default" ng-click="cancel()">{{ config.decline }}</div>\n        <div class="btn btn-primary" ng-click="ok(dateTime)">{{ config.accept }}</div>\n    </div>\n</div>\n')}]);